s = 17.3; // начальное расстояние (км)
fi = 0;   // направление лодки (θ = 0)

// Функция движения катера: dr/dθ = r/5
function dr = f(theta, r)
    dr = r / 5;
endfunction

// Начальные условия для случая 1 (θ = 0)
theta0 = 0;
r0 = s;
theta = theta0:0.01:2*%pi; // θ от 0 до 2π

// Решение дифференциального уравнения
r = ode(r0, theta0, theta, f);

// Траектория лодки (r = s + t, θ = 0)
t_max = 30; // время для визуализации
t = 0:0.1:t_max;
r_boat = s + t; // лодка удаляется от полюса
theta_boat = fi * ones(t);

// Построение графика
clf();
polarplot(theta, r, style=color("green")); // Катер
polarplot(theta_boat, r_boat, style=color("red")); // Лодка

// Найти точку пересечения (аналитически)
// Уравнение: s * e^(θ/5) = s + t
// При θ = 0 (траектория лодки):
r_intersect = s * exp(0/5) = s;
t_intersect = 0;

// Отметить начальную точку
polarplot(theta0, r0, "ko"); 
legend(["Катер", "Лодка", "Начальная точка"]);
title("Траектории катера и лодки (случай 1)");
